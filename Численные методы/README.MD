## Проект: Оценка рыночной стоимости автомобилей

### Описание задачи
Сервис по продаже автомобилей с пробегом «Не бит, не крашен» разрабатывает приложение для привлечения новых клиентов. Задача — построить модель, которая сможет определять рыночную стоимость автомобиля по техническим характеристикам, комплектации и ценам других автомобилей.

Основные критерии:
- Высокая точность предсказания (метрика RMSE).
- Быстрое время обучения и предсказания.

### Использованные данные
1. **DateCrawled** — дата скачивания анкеты.
2. **Price** — цена автомобиля.
3. **VehicleType** — тип кузова.
4. **RegistrationYear** — год регистрации.
5. **Gearbox** — тип коробки передач.
6. **Power** — мощность двигателя (л.с.).
7. **Model** — модель автомобиля.
8. **Kilometer** — пробег (км).
9. **FuelType** — тип топлива.
10. **Brand** — марка автомобиля.
11. **Repaired** — была ли машина в ремонте.
12. **DateCreated** — дата создания анкеты.

### Основные этапы работы
1. **Предобработка данных:**
   - Удаление дубликатов и обработка пропусков.
   - Замена бензина (gasoline) на единую категорию (petrol).
   - Устранение выбросов в данных по мощности, пробегу и цене.
   - Кодирование категориальных переменных с использованием OneHotEncoder.
   
2. **Исследовательский анализ данных (EDA):**
   - Построены гистограммы количественных и категориальных признаков.
   - Удалены неинформативные признаки (например, `NumberOfPictures` и `PostalCode`).
   - Проведён корреляционный анализ и устранена мультиколлинеарность.

3. **Разработка моделей:**
   - Модели машинного обучения: XGBoost, CatBoost, LightGBM, kNN, DecisionTree.
   - Поиск гиперпараметров с использованием `OptunaSearchCV`.
   - Кросс-валидация для проверки качества моделей.

4. **Оценка моделей:**
   - Лучшая модель: **XGBoost**.
   - RMSE на тестовой выборке: **2094**.
   - Время обучения модели: **3 минуты 57 секунд**.
   - Время предсказания: **420 мс**.

### Результаты
- Таблица сравнений моделей:
  | Модель         | RMSE (тест) | Время обучения | Время предсказания |
  |----------------|-------------|----------------|---------------------|
  | **XGBoost**    | 2094        | 3 мин 57 сек   | 420 мс             |
  | CatBoost       | 2156        | 4 мин 4 сек    | 471 мс             |
  | LightGBM       | 2348        | 4 мин 32 сек   | 594 мс             |
  | kNN            | 2135        | 7 мин 34 сек   | 6.53 сек           |
  | DecisionTree   | 2192        | 5 мин 32 сек   | 359 мс             |

- После дополнительного перебора гиперпараметров для XGBoost:
  - RMSE на тестовой выборке: **2015**.
  - Параметры: `n_estimators = 356`, `min_tree_child_weight = 22`, `max_depth = 4`.

### Заключение
Модель XGBoost полностью соответствует требованиям заказчика, обеспечивая высокую точность и быстрое время предсказания. Она идеально подходит для внедрения в приложение, позволяя клиентам быстро рассчитывать рыночную стоимость автомобилей.